function generateWrappper(t,e){for(var n={imports:{},deployFn:"",viewFn:[],txFn:[],eventFn:[],eventStruct:[],eventTypes:[]},s=t+"Wrapper",r=0;r<e.length;r++){var p=e[r];"constructor"===p.type?n.deployFn=makeDeployFunction(p,n,s,"    "):"function"===p.type?"view"===p.stateMutability||"pure"===p.stateMutability?n.viewFn.push(makeViewFunction(p,n,"    ")):n.txFn.push(makeTransactionFunction(p,n,"    ",t)):"event"===p.type&&(n.eventTypes.push(p.name),n.eventStruct.push(makeEventStruct(p,n,"")),n.eventFn.push(makeEventFunc(p,n,"    ")))}n.imports.SmartContractInterface=!0,n.imports.AddressLike=!0,n.imports.Address=!0,n.imports.QuantityLike=!0,n.imports.BlockTag=!0,n.imports.RPCOptions=!0,n.imports.ABILike=!0,n.imports.SmartContractEvent=!0;var u=[];u.push("// "+t+" contract wrapper"),u.push(""),u.push('"use strict";'),u.push(""),u.push("import { "+Object.keys(n.imports).join(", ")+' } from "@asanrom/smart-contract-wrapper";'),u.push(""),u.push("export class "+s+" {"),u.push("    public address: Address;"),u.push("    private _contractInterface: SmartContractInterface;"),u.push(""),u.push(n.deployFn),u.push(""),u.push("    constructor(address: AddressLike, rpcOptions: RPCOptions) {"),u.push("        this._contractInterface = new SmartContractInterface(address, CONTRACT_ABI, rpcOptions);"),u.push("        this.address = this._contractInterface.address;"),u.push("    }");for(r=0;r<n.viewFn.length;r++)u.push(""),u.push(n.viewFn[r]);for(r=0;r<n.txFn.length;r++)u.push(""),u.push(n.txFn[r]);u.push(""),u.push("    public async findEvents(fromBlock: QuantityLike | BlockTag, toBlock: QuantityLike | BlockTag): Promise<"+t+"EventCollection> {"),u.push("        const events = await this._contractInterface.findEvents(fromBlock, toBlock);"),u.push("        return new "+t+"EventCollection(events);"),u.push("    }"),u.push("}"),u.push(""),u.push("export type "+t+"EventType = "+(n.eventTypes.map(function(t){return JSON.stringify(t)}).join(" | ")||'"string"')+";"),u.push(""),u.push("export class "+t+"EventCollection {"),u.push("    public events: SmartContractEvent[];"),u.push("    constructor(events: SmartContractEvent[]) {"),u.push("        this.events = events;"),u.push("    }"),u.push(""),u.push("    public length(): number {"),u.push("        return this.events.length"),u.push("    }"),u.push(""),u.push("    public getEventType(index: number): "+t+"EventType {"),u.push("        return <any>this.events[index].name"),u.push("    }"),u.push(""),u.push("    public filter(eventType: "+t+"EventType): "+t+"EventCollection {"),u.push("        return new "+t+"EventCollection(this.events.filter(event => event.name === eventType));"),u.push("    }");for(r=0;r<n.eventFn.length;r++)u.push(""),u.push(n.eventFn[r]);u.push("}");for(r=0;r<n.eventStruct.length;r++)u.push(""),u.push(n.eventStruct[r]);return u.push(""),u.push("const CONTRACT_ABI: ABILike = "+JSON.stringify(e,null,"    ")+";"),u.join("\n")+"\n"}function makeDeployFunction(t,e,n,s){var r=[],p=makeFunctionParams(t.inputs,e);return t.payable&&(e.imports.QuantityLike=!0,p.push("value: QuantityLike")),e.imports.BytesLike=!0,p.push("bytecode: BytesLike"),e.imports.TransactionSendingOptions=!0,p.push("options: TransactionSendingOptions"),e.imports.deploySmartContract=!0,r.push("public static async deploy("+p.join(", ")+"): Promise<"+n+"> {"),r.push("    const deployed = await deploySmartContract(bytecode, CONTRACT_ABI, ["+getCallArgumentsList(t)+"], "+(t.payable?"value":"0")+", options);"),r.push("    if (deployed.receipt.status > BigInt(0)) {"),r.push("        return new "+n+"(deployed.result, options);"),r.push("    } else {"),r.push('        throw new Error("Transaction reverted");'),r.push("    }"),r.push("}"),r.map(function(t){return s+t}).join("\n")}function makeFunctionParams(t,n){return t.map(function(t,e){return(t.name||"param_"+e)+": "+getABITypescriptType(t.type,n,!0)})}function getCallArgumentsList(t){return t.inputs.map(function(t,e){return t.name||"param_"+e}).join(", ")}function getABITypescriptType(t,e,n){var s,r=/\[([0-9]+)?\]$/.exec(t+="");if(r?(s=!0,t=t.substr(0,t.length-r[0].length)):s=!1,"address"===t)return n?(e.imports.AddressLike=!0,"AddressLike"+(s?"[]":"")):(e.imports.Address=!0,"Address"+(s?"[]":""));if("string"===t)return"string"+(s?"[]":"");if("bool"===t)return"boolean"+(s?"[]":"");if(/^(u)?int([0-9]+)?$/.test(t))return n?(e.imports.QuantityLike=!0,"QuantityLike"+(s?"[]":"")):(e.imports.Quantity=!0,"Quantity"+(s?"[]":""));if(/^bytes([0-9]+)?$/.test(t))return n?(e.imports.BytesLike=!0,"BytesLike"+(s?"[]":"")):"string"+(s?"[]":"");if(/^\(.*\)$/.test(t)){for(var p=t.substr(1,t.length-1),u="",i=0,o=[],a=0;a<p.length;a++){var c=p.charAt(a);"("===c?(u+=c,i++):")"===c?(u+=c,i--):","===c&&0===i?(o.push(u),u=""):u+=c}return u&&o.push(u),"["+o.map(function(t){return getABITypescriptType(t,e,n)}).join(", ")+"]"}}function makeFunctionResultType(t,e,n){return"void"===e?"void":"single"===e?getABITypescriptType(t[0].type,n,!1):"tuple"===e?"["+t.map(function(t){return getABITypescriptType(t.type,n,!1)}).join(", ")+"]":"struct"===e?"{"+t.map(function(t){return t.name+": "+getABITypescriptType(t.type,n,!1)}).join(", ")+"}":"any"}function makeViewFunction(t,e,n){var s,r=[],p=makeFunctionParams(t.inputs,e);if(e.imports.MethodCallingOptions=!0,p.push("options?: MethodCallingOptions"),0===t.outputs.length)s="void";else if(1===t.outputs.length)s="single";else{s="struct";for(var u=0;u<t.outputs.length;u++)if(!t.outputs[u].name){s="tuple";break}}if(r.push("public async "+t.name+"("+p.join(", ")+"): Promise<"+makeFunctionResultType(t.outputs,s,e)+"> {"),r.push("    "+("void"===s?"":"const result: any = ")+'await this._contractInterface.callViewMethod("'+t.name+'", ['+getCallArgumentsList(t)+"], options || {});"),"single"===s)r.push("    return result[0]");else if("tuple"===s)r.push("    return result");else if("struct"===s){r.push("    return {");for(u=0;u<t.outputs.length;u++){var i=t.outputs[u];r.push("        "+i.name+": result["+u+"],")}r.push("    };")}return r.push("}"),r.map(function(t){return n+t}).join("\n")}function makeTransactionFunction(t,e,n,s){var r=[],p=s+"EventCollection",s=makeFunctionParams(t.inputs,e);return t.payable&&(e.imports.QuantityLike=!0,s.push("value: QuantityLike")),e.imports.MethodTransactionOptions=!0,s.push("options: MethodTransactionOptions"),e.imports.SmartContractEvent=!0,e.imports.TransactionResult=!0,r.push("public async "+t.name+"("+s.join(", ")+"): Promise<TransactionResult<"+p+">> {"),t.payable?r.push('    const result = await this._contractInterface.callPayableMethod("'+t.name+'", ['+getCallArgumentsList(t)+"], value, options);"):r.push('    const result = await this._contractInterface.callMutableMethod("'+t.name+'", ['+getCallArgumentsList(t)+"], options);"),r.push(""),r.push("    if (result.receipt.status > BigInt(0)) {"),r.push("        const decodedEvents = this._contractInterface.parseTransactionLogs(result.receipt.logs)"),r.push("        return { receipt: result.receipt, result: new "+p+"(decodedEvents) };"),r.push("    } else {"),r.push('        throw new Error("Transaction reverted");'),r.push("    }"),r.push("}"),r.map(function(t){return n+t}).join("\n")}function makeEventStruct(t,e,n){var s=[];s.push("export interface "+t.name+"Event {");for(var r=0;r<t.inputs.length;r++){var p=t.inputs[r];s.push("    "+(p.name||"_"+r)+": "+getABITypescriptType(p.type,e,!1)+",")}return s.push("}"),s.map(function(t){return n+t}).join("\n")}function makeEventFunc(t,e,n){var s=[];e.imports.SmartContractEventWrapper=!0,e.imports.SmartContractEvent=!0,s.push("public get"+t.name+"Event(index: number): SmartContractEventWrapper<"+t.name+"Event> {"),s.push("    const result: any = this.events[index].parameters;"),s.push("    return {"),s.push("        event: this.events[index],"),s.push("        data: {");for(var r=0;r<t.inputs.length;r++){var p=t.inputs[r];s.push("            "+p.name+": result["+r+"],")}return s.push("        },"),s.push("    };"),s.push("}"),s.map(function(t){return n+t}).join("\n")}